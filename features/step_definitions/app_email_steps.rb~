Given(/^Action Mailer delivers via SMTP$/) do
  ActionMailer::Base.delivery_method = :smtp
end

When(/^I log into gmail with:$/) do |table|
  details = table.hashes.first
	@gmail = Gmail.connect(details["username"], details["password"])
end

Then(/^there should be an email from Ticketee in my inbox$/) do
	
  @gmail.inbox.find(:unread, :from => "testerticketee@gmail.com").each do |mail|
							p mail.subject
							if mail.subject =~ /^\[ticketee\]/
								mail.delete!
								@received_mail = true
								break;
							end
					 end
	@received_mail.should be_true
end

